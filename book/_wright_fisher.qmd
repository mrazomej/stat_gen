### Beanbag genetics and the Wright-Fisher model

As it has hopefully become clear so far in the book, we are not afraid to make
gross oversimplifications about the process we are trying to model. After all,
these simplifications and idealizations allow us to make analytical and
computational progress, distilling the relevant features of complex phenomena.
Thus, unapologetically, we will continue returning to "beanbag genetics" as a
way to study evolution. Arguably, the most important beanbag genetics model is
the so-called Wright-Fisher model, independently created by two field
pioneers---Sewall Wright and Ronald Fisher. Ironically, the model carries both
names since Fisher and Wright disagreed and bitterly fought about almost every
topic in population genetics throughout their prolific careers.

The Wright-Fisher model assumes that a population of diploid organisms has a
fixed population size and non-overlapping generations. In other words, if at
generation $t$, there are $N$ organisms (therefore $2N$ alleles due to
diploidy), generation $t + 1$ will also have $N$ organisms. Still, none of the
ones from the previous generation will make it to the next one. Furthermore,
although sexual reproduction involves two different sexes---also known as mating
types---the model takes the beanbag genetics to the extreme. As schematized in
@fig-beanbag_genetics, new organisms are created by blindly grabbing one allele
from the bag, writing down its identity, and then putting it back in the bag to
repeat the process for the second allele. In other words, we sample both alleles
with replacement. This oversimplification allows us to write a simple
mathematical description of how the probability of having a particular allele
frequency in the population changes over time.

![Beanbag genetics schematic](./figures/placeholder.jpg){#fig-beanbag_genetics}

Thinking about the Buri experiment from the previous section, let us assume that
$N = 16$ individuals conform each generation. To stick to our previous notation,
we will define $A$ as the red-eye allele and $a$ as the white-eye allele. Our
objective is to build the transition probability $P_{i\rightarrow j}(t)$ of
transitioning from having $i$ copies of, say, allele $A$ in generation $t-1$ to
$j$ copies in generation $t$. At generation $t$, the probability of drawing a
copy of allele $A$, $p_A(t)$ is given by
$$
p_A(t) = \frac{i}{2N},
$${#eq-prob_A_wf}
where, as before, $i$ is the number of copies of allele $A$ in generation $t-1$.
Likewise, the probability of drawing a copy of allele $a$ at generation $t$ is
$$
p_a(t) = 1 - p_A(t) = 1 - \frac{i}{2N}.
$${#eq-prob_a_wf}
Given that each time we draw an allele, we replace it in the beanbag, each draw
is independent of the others. Thus, the probability of drawing, say, $j$ copies
of allele $A$ in consecutive trials is given as the multiplication of
@eq-prob_A_wf by itself $j$ times. Finally, to construct our transition
probability, we must take into account that drawing $j$ copies of allele $A$ and
$2N - j$ copies of allele $a$ can happen in many different ways (see [Math
behind the model @sec-math_behin_bioniaml_coefficient]), resulting in
$$
P_{i\rightarrow j}(t) = 
\overbrace{\frac{2N!}{i! \left(2N! - i\right)!}}
^{\text{order doesn't matter}}
\underbrace{\left( \frac{i}{2N}\right)^j}_
{\text{draw $j$ copies of $A$}}
\overbrace{\left( 1 - \frac{i}{2N} \right)^{2N - j}}^
{\text{draw $j - 2N$ copies of $a$}}.
$${#eq-pij_wf}




___
{{< include __math_behind_binomial_coefficient.qmd >}}
---